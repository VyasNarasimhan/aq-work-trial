>
>     # Convert amount to float if it's a string
>     try:
>         amount_float = float(amount)
>         if amount_float <= 0:
>             continue
>     except (ValueError, TypeError):
>         continue
>
>     # Check for missing timestamp
>     if not txn.get('timestamp'):
>         continue
>
>     # Check for valid user_id (1-30)
>     user_id = txn.get('user_id')
>     if user_id is None:
>         continue
>
>     try:
>         user_id_int = int(user_id)
>         if user_id_int < 1 or user_id_int > 30:
>             continue
>     except (ValueError, TypeError):
>         continue
>
>     valid_transactions.append(txn)
>
> # Write valid transactions
> with open('/backup/valid_transactions.json', 'w') as f:
>     json.dump(valid_transactions, f, indent=2)
>     f.write('\n')
>
> print(f'Valid transactions: {len(valid_transactions)} valid records')
> EOF
root@2b0e848428bd:/backup# python3 /tmp/clean_transactions.py; tmux wait -S done
Valid transactions: 100 valid records
root@2b0e848428bd:/backup# ls -la /backup/clean_users.csv /backup/valid_transactions.json; tmux wait -S done
-rw-r--r-- 1 root root  2052 Dec  4 19:04 /backup/clean_users.csv
-rw-r--r-- 1 root root 14573 Dec  4 19:04 /backup/valid_transactions.json
root@2b0e848428bd:/backup#
