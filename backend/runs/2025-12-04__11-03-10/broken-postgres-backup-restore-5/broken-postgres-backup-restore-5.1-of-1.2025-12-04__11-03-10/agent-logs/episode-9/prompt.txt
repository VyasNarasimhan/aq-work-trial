>     ['su', '-', 'postgres', '-c',
>      "psql -d production_db -t -c \"SELECT COUNT(*) FROM users WHERE status='active';\""],
>     capture_output=True, text=True
> )
> active_users = int(result.stdout.strip())
>
> result = subprocess.run(
>     ['su', '-', 'postgres', '-c',
>      "psql -d production_db -t -c \"SELECT COUNT(*) FROM transactions;\""],
>     capture_output=True, text=True
> )
> total_transactions = int(result.stdout.strip())
>
> result = subprocess.run(
>     ['su', '-', 'postgres', '-c',
>      "psql -d production_db -t -c \"SELECT SUM(amount) FROM transactions;\""],
>     capture_output=True, text=True
> )
> total_amount = float(result.stdout.strip())
>
> result = subprocess.run(
>     ['su', '-', 'postgres', '-c',
>      "psql -d production_db -t -c \"SELECT AVG(total) FROM (SELECT user_id, SUM(amount) as total FROM transactions GROUP BY user_id) as user_totals;\""],
>     capture_output=True, text=True
> )
> avg_per_user = float(result.stdout.strip())
>
> # Write statistics report
> with open('/backup/db_stats.txt', 'w') as f:
>     f.write('DATABASE STATISTICS\n')
>     f.write('==================\n')
>     f.write(f'Total Users: {total_users}\n')
>     f.write(f'Active Users: {active_users}\n')
>     f.write(f'Total Transactions: {total_transactions}\n')
>     f.write(f'Total Amount: {total_amount:.2f}\n')
>     f.write(f'Average per User: {avg_per_user:.2f}\n')
>
> print('Database statistics report generated')
> EOF

