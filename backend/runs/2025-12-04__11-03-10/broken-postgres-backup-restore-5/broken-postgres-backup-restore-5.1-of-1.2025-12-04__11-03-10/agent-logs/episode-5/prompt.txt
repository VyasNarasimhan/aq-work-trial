>     writer = csv.DictWriter(f, fieldnames=['user_id', 'username', 'email', 'created_at', 'status'])
>     writer.writeheader()
>     writer.writerows(valid_users)
>
> print(f"Cleaned users: {len(valid_users)} valid rows")
>
> # Clean transactions JSON
> with open('/backup/transactions_backup.json', 'r') as f:
>     transactions = json.load(f)
>
> valid_transactions = []
> for txn in transactions:
>     # Check for null or missing transaction_id
>     if txn.get('transaction_id') is None:
>         continue
>     # Check for null or missing user_id, or invalid range
>     if txn.get('user_id') is None or txn['user_id'] < 1 or txn['user_id'] > 30:
>         continue
>     # Check for null, negative, or zero amount
>     try:
>         amount = float(txn.get('amount', 0))
>         if amount <= 0:
>             continue
>     except (ValueError, TypeError):
>         continue
>     # Check for missing timestamp
>     if txn.get('timestamp') is None or txn.get('timestamp') == '':
>         continue
>     valid_transactions.append(txn)
>
> # Write valid transactions
> with open('/backup/valid_transactions.json', 'w') as f:
>     json.dump(valid_transactions, f, indent=2)
>     f.write('\n')
>
> print(f"Valid transactions: {len(valid_transactions)} valid rows")
> EOF
Cleaned users: 30 valid rows
Valid transactions: 100 valid rows
root@bc0c6c5ec4c0:/backup#
