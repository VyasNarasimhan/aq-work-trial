>     transactions = json.load(f)
>
> # Insert transactions
> for txn in transactions:
>     cur.execute(
>         "INSERT INTO transactions (transaction_id, user_id, amount, timestamp, description) VALUES (%s, %s, %s, %s, %s)",
>         (txn['transaction_id'], txn['user_id'], txn['amount'], txn['timestamp'], txn['description'])
>     )
>
> conn.commit()
> print(f"Imported {len(transactions)} transactions")
>
> cur.close()
> conn.close()
> EOF
Traceback (most recent call last):
  File "<stdin>", line 2, in <module>
ModuleNotFoundError: No module named 'psycopg2'
root@bc0c6c5ec4c0:/backup# su - postgres -c "psql -d production_db -c \"COPY users(user_id, username, email, created_at, status) FROM '/backup/clean_users.csv'
WITH (FORMAT csv, HEADER true);\""; tmux wait -S done
psql: error: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: FATAL:  database "production_db" does not exist
root@bc0c6c5ec4c0:/backup# python3 << 'EOF'
> import json
>
> # Load valid transactions and create SQL insert statements
> with open('/backup/valid_transactions.json', 'r') as f:
>     transactions = json.load(f)
>
> with open('/backup/import_transactions.sql', 'w') as f:
>     for txn in transactions:
>         desc = txn['description'].replace("'", "''")
>         f.write(f"INSERT INTO transactions (transaction_id, user_id, amount, timestamp, description) VALUES ({txn['transaction_id']}, {txn['user_id']}, {txn['
amount']}, '{txn['timestamp']}', '{desc}');\n")
>
> print(f"Created SQL file with {len(transactions)} insert statements")
> EOF
Created SQL file with 100 insert statements
root@bc0c6c5ec4c0:/backup# su - postgres -c "psql -d production_db -f /backup/import_transactions.sql"; tmux wait -S done
psql: error: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: FATAL:  database "production_db" does not exist
root@bc0c6c5ec4c0:/backup#
