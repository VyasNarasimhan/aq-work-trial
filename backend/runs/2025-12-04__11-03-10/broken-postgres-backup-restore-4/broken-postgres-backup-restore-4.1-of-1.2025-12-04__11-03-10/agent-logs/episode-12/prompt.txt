Database statistics generated
root@9d5ed6174de7:/backup# cat /backup/db_stats.txt; tmux wait -S done
DATABASE STATISTICS
==================
Total Users: 30
Active Users: 13
Total Transactions: 100
Total Amount: 53109.46
Average per User: 1770.32
root@9d5ed6174de7:/backup# su - postgres -c "psql -d production_db -t -A -F',' -c 'SELECT u.username, ROUND(SUM(t.amount)::numeric, 2) as total_amount FROM user
s u JOIN transactions t ON u.user_id = t.user_id GROUP BY u.username ORDER BY total_amount DESC, u.username ASC LIMIT 10;'" > /backup/top_users.csv; tmux wait -
S done
root@9d5ed6174de7:/backup# cat > /tmp/fix_top_users.py << 'EOF'
> import csv
>
> # Read the data
> with open('/backup/top_users.csv', 'r') as f:
>     lines = f.readlines()
>
> # Write with proper header
> with open('/backup/top_users.csv', 'w', newline='') as f:
>     f.write('username,total_amount\n')
>     for line in lines:
>         f.write(line)
>
> EOF
root@9d5ed6174de7:/backup# python3 /tmp/fix_top_users.py; tmux wait -S done
root@9d5ed6174de7:/backup# cat /backup/top_users.csv; tmux wait -S done
username,total_amount
zara_ahmed,4400.17
alice_smith,3682.87
victor_von,3451.21
donna_noble,3225.49
xavier_prof,2990.51
nick_fury,2709.20
wade_wilson,2678.95
tony_stark,2637.00
frank_white,2539.97
charlie_brown,2525.32
root@9d5ed6174de7:/backup#
