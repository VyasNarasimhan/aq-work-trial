>
> conn.commit()
> cur.close()
> conn.close()
>
> print(f"Imported {len(transactions)} transactions")
> EOF
root@9d5ed6174de7:/backup# python3 /tmp/import_transactions.py; tmux wait -S done
Traceback (most recent call last):
  File "/tmp/import_transactions.py", line 2, in <module>
    import psycopg2
ModuleNotFoundError: No module named 'psycopg2'
root@9d5ed6174de7:/backup# cat > /tmp/import_transactions.py << 'EOF'
> import json
>
> # Read valid transactions
> with open('/backup/valid_transactions.json', 'r') as f:
>     transactions = json.load(f)
>
> # Generate SQL file
> with open('/tmp/transactions.sql', 'w') as f:
>     for txn in transactions:
>         # Escape single quotes in description
>         desc = txn['description'].replace("'", "''")
>         sql = f"INSERT INTO transactions (transaction_id, user_id, amount, timestamp, description) VALUES ({txn['transaction_id']}, {txn['user_id']}, {txn['am
ount']}, '{txn['timestamp']}', '{desc}');\n"
>         f.write(sql)
>
> print(f"Generated SQL for {len(transactions)} transactions")
> EOF
root@9d5ed6174de7:/backup# python3 /tmp/import_transactions.py; tmux wait -S done
Generated SQL for 100 transactions
root@9d5ed6174de7:/backup# su - postgres -c "psql -d production_db -f /tmp/transactions.sql" > /dev/null 2>&1; tmux wait -S done
root@9d5ed6174de7:/backup# su - postgres -c "psql -d production_db -c 'SELECT COUNT(*) FROM transactions;'"; tmux wait -S done
 count
-------
   100
(1 row)

root@9d5ed6174de7:/backup#
