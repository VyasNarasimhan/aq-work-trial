>     try:
>         user_id = int(txn.get('user_id', 0))
>         if user_id < 1 or user_id > 30:
>             continue
>     except (ValueError, TypeError):
>         continue
>     valid_transactions.append(txn)
>
> # Write valid transactions JSON
> with open('/backup/valid_transactions.json', 'w') as f:
>     json.dump(valid_transactions, f)
>     f.write('\n')
>
> print(f"Valid transactions: {len(valid_transactions)} valid entries")
> EOF
root@2932292ad2c5:/backup# python3 /backup/clean_data.py; tmux wait -S done
Cleaned users: 30 valid rows
Valid transactions: 100 valid entries
root@2932292ad2c5:/backup# head -5 /backup/clean_users.csv; tmux wait -S done
user_id,username,email,created_at,status
1,alice_smith,alice_smith@example.com,2024-11-21 01:25:46,inactive
2,bob_jones,bob_jones@example.com,2025-06-28 01:25:46,active
3,charlie_brown,charlie_brown@example.com,2025-08-13 01:25:46,suspended
4,diana_prince,diana_prince@example.com,2025-08-05 01:25:46,inactive
root@2932292ad2c5:/backup# wc -l /backup/clean_users.csv /backup/valid_transactions.json; tmux wait -S done
   31 /backup/clean_users.csv
    1 /backup/valid_transactions.json
   32 total
root@2932292ad2c5:/backup# psql -U postgres -d production_db -c "\d users"; tmux wait -S done
psql: error: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: FATAL:  Peer authentication failed for user "postgres"
root@2932292ad2c5:/backup# psql -U postgres -d production_db -c "\d transactions"; tmux wait -S done
psql: error: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: FATAL:  Peer authentication failed for user "postgres"
root@2932292ad2c5:/backup# su - postgres -c "psql -d production_db -c '\d users'"; tmux wait -S done
psql: error: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: FATAL:  database "production_db" does not exist
root@2932292ad2c5:/backup# su - postgres -c "psql -d production_db -c '\d transactions'"; tmux wait -S done
psql: error: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: FATAL:  database "production_db" does not exist
root@2932292ad2c5:/backup# su - postgres -c "psql -d production_db -c \"COPY users(user_id, username, email, created_at, status) FROM '/backup/clean_users.csv'
WITH (FORMAT csv, HEADER true);\""; tmux wait -S done
psql: error: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: FATAL:  database "production_db" does not exist
root@2932292ad2c5:/backup#
