>
> valid_transactions = []
>
> for trans in transactions:
>     # Check if transaction_id is null or missing
>     if trans.get('transaction_id') is None:
>         continue
>
>     # Check if user_id is valid (1-30)
>     user_id = trans.get('user_id')
>     if user_id is None or user_id < 1 or user_id > 30:
>         continue
>
>     # Check if amount is valid (positive number)
>     amount = trans.get('amount')
>     if amount is None:
>         continue
>
>     # Check if amount is a valid number and positive
>     try:
>         amount_float = float(amount)
>         if amount_float <= 0:
>             continue
>     except (ValueError, TypeError):
>         continue
>
>     # Check if timestamp is not null
>     if trans.get('timestamp') is None:
>         continue
>
>     # Add to valid transactions
>     valid_transactions.append(trans)
>
> # Write to output file
> with open('/backup/valid_transactions.json', 'w') as f:
>     json.dump(valid_transactions, f, indent=2)
>     f.write('\n')
> EOF
root@dc6ca25e21c7:/backup# python3 /backup/clean_transactions.py; tmux wait -S done
root@dc6ca25e21c7:/backup#
