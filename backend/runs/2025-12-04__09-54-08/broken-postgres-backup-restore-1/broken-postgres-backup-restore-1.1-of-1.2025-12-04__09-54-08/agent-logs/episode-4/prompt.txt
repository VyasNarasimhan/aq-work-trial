> with open('/backup/transactions_backup.json', 'r') as f:
>     transactions = json.load(f)
>
> valid_transactions = []
> for txn in transactions:
>     # Check transaction_id is not null
>     if txn.get('transaction_id') is None:
>         continue
>     # Check amount is not null and is positive
>     if txn.get('amount') is None or txn['amount'] <= 0:
>         continue
>     # Check timestamp exists
>     if not txn.get('timestamp'):
>         continue
>     # Check user_id is valid (1-30)
>     if txn.get('user_id') is None or txn['user_id'] < 1 or txn['user_id'] > 30:
>         continue
>     valid_transactions.append(txn)
>
> print(f"Valid transactions: {len(valid_transactions)}")
>
> # Write valid transactions to JSON
> with open('/backup/valid_transactions.json', 'w') as f:
>     json.dump(valid_transactions, f, indent=2)
>     f.write('\n')
>
> print("Transactions cleaned and saved to valid_transactions.json")
> EOF
root@ad2e6717b5d5:/backup# python3 /backup/clean_data.py; tmux wait -S done
Cleaning users data...
Valid users: 30
Users cleaned and saved to clean_users.csv

Cleaning transactions data...
Traceback (most recent call last):
  File "/backup/clean_data.py", line 50, in <module>
    if txn.get('amount') is None or txn['amount'] <= 0:
                                    ^^^^^^^^^^^^^^^^^^
TypeError: '<=' not supported between instances of 'str' and 'int'
root@ad2e6717b5d5:/backup#
