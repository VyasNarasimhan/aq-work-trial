>
> # Generate SQL INSERT statements
> sql_statements = []
> for txn in transactions:
>     sql = f"INSERT INTO transactions (transaction_id, user_id, amount, timestamp, description) VALUES ({txn['transaction_id']}, {txn['user_id']}, {txn['amount
']}, '{txn['timestamp']}', '{txn['description'].replace("'", "''")}')"
>     sql_statements.append(sql)
>
> # Write SQL file
> with open('/backup/import_transactions.sql', 'w') as f:
>     for sql in sql_statements:
>         f.write(sql + ';\n')
>
> print(f"Generated SQL for {len(transactions)} transactions")
> EOF
root@5dedd0e6de41:/backup# python3 /backup/import_transactions.py; tmux wait -S done
Generated SQL for 100 transactions
root@5dedd0e6de41:/backup# psql -U postgres -d production_db -f /backup/import_transactions.sql; tmux wait -S done
psql: error: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: FATAL:  Peer authentication failed for user "postgres"
root@5dedd0e6de41:/backup# psql -U postgres -d production_db -c "SELECT COUNT(*) FROM users;"; tmux wait -S done
psql: error: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: FATAL:  Peer authentication failed for user "postgres"
root@5dedd0e6de41:/backup# psql -U postgres -d production_db -c "SELECT COUNT(*) FROM transactions;"; tmux wait -S done
psql: error: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: FATAL:  Peer authentication failed for user "postgres"
root@5dedd0e6de41:/backup# sudo -u postgres psql -d production_db -f /backup/import_users.sql; tmux wait -S done
bash: sudo: command not found
root@5dedd0e6de41:/backup# sudo -u postgres psql -d production_db -f /backup/import_transactions.sql; tmux wait -S done
bash: sudo: command not found
root@5dedd0e6de41:/backup# sudo -u postgres psql -d production_db -c "SELECT COUNT(*) FROM users;"; tmux wait -S done
bash: sudo: command not found
root@5dedd0e6de41:/backup# sudo -u postgres psql -d production_db -c "SELECT COUNT(*) FROM transactions;"; tmux wait -S done
bash: sudo: command not found
root@5dedd0e6de41:/backup# su - postgres -c "psql -d production_db -f /backup/import_users.sql"; tmux wait -S done
psql: error: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: FATAL:  database "production_db" does not exist
root@5dedd0e6de41:/backup# su - postgres -c "psql -d production_db -f /backup/import_transactions.sql"; tmux wait -S done
psql: error: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: FATAL:  database "production_db" does not exist
root@5dedd0e6de41:/backup# su - postgres -c "psql -d production_db -c 'SELECT COUNT(*) FROM users;'"; tmux wait -S done
psql: error: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: FATAL:  database "production_db" does not exist
root@5dedd0e6de41:/backup# su - postgres -c "psql -d production_db -c 'SELECT COUNT(*) FROM transactions;'"; tmux wait -S done
psql: error: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: FATAL:  database "production_db" does not exist
root@5dedd0e6de41:/backup#
