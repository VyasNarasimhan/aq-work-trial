root@fd149cd359fd:/backup# ls -la /backup/; tmux wait -S done
total 40
drwxr-xr-x 1 root root  4096 Dec  4 16:59 .
drwxr-xr-x 1 root root  4096 Dec  4 17:54 ..
-rw-r--r-- 1 root root   945 Dec  4 16:54 backup_metadata.log
-rw-r--r-- 1 root root   718 Dec  4 16:54 database.sql
-rw-r--r-- 1 root root   703 Dec  4 16:54 postgresql.conf
-rw-r--r-- 1 root root 15425 Dec  4 16:54 transactions_backup.json
-rw-r--r-- 1 root root  2351 Dec  4 16:54 users_export.csv
root@fd149cd359fd:/backup# service postgresql start; tmux wait -S done
 * Starting PostgreSQL 16 database server                                                                                                                [ OK ]
root@fd149cd359fd:/backup# head -20 /backup/database.sql; tmux wait -S done
-- PostgreSQL database dump
-- This dump contains the schema and some sample data
-- Note: Some statements may have errors that need to be fixed

-- Create users table
CREATE TABLE IF NOT EXISTS users (
    user_id INTEGER PRIMARY KEY,
    username VARCHAR(100) NOT NULL,
    email VARCHAR(255) NOT NULL,
    created_at TIMESTAMP,
    status VARCHAR(20)
);

-- Create transactions table
CREATE TABLE IF NOT EXISTS transactions (
    transaction_id INTEGER PRIMARY KEY,
    user_id INTEGER,
    amount DECIMAL(10,2),
    timestamp TIMESTAMP,
    description TEXT,
root@fd149cd359fd:/backup# head -10 /backup/users_export.csv; tmux wait -S done
user_id,username,email,created_at,status
1,alice_smith,alice_smith@example.com,2024-11-21 01:25:46,inactive
2,bob_jones,bob_jones@example.com,2025-06-28 01:25:46,active
3,charlie_brown,charlie_brown@example.com,2025-08-13 01:25:46,suspended
4,diana_prince,diana_prince@example.com,2025-08-05 01:25:46,inactive
5,eve_adams,eve_adams@example.com,2025-09-08 01:25:46,inactive
6,frank_white,frank_white@example.com,2025-09-04 01:25:46,active
7,grace_lee,grace_lee@example.com,2025-06-05 01:25:46,active
8,henry_ford,henry_ford@example.com,2025-07-25 01:25:46,inactive
9,iris_west,iris_west@example.com,2025-03-23 01:25:46,suspended
root@fd149cd359fd:/backup# head -10 /backup/transactions_backup.json; tmux wait -S done
[
  {
    "transaction_id": 1,
    "user_id": 16,
    "amount": 46.0,
    "timestamp": "2025-07-16 01:25:56",
    "description": "Subscription"
  },
  {
    "transaction_id": 2,
root@fd149cd359fd:/backup# cat /backup/backup_metadata.log; tmux wait -S done
[2025-09-28 03:00:00] INFO: Starting database backup process
[2025-09-28 03:00:01] INFO: Backup initiated by: admin
[2025-09-28 03:00:01] INFO: Backup type: Full
[2025-09-28 03:00:02] INFO: Connecting to database: production_db
[2025-09-28 03:00:03] INFO: Connection successful
[2025-09-28 03:00:05] INFO: Backing up table: users
[2025-09-28 03:00:06] INFO: Table 'users' backed up successfully - 30 rows
[2025-09-28 03:00:07] INFO: Backing up table: transactions
[2025-09-28 03:00:09] INFO: Table 'transactions' backed up successfully - 100 rows
[2025-09-28 03:00:10] INFO: Total tables backed up: 2
[2025-09-28 03:00:10] INFO: Total rows backed up: 130
[2025-09-28 03:00:11] INFO: Running integrity check
[2025-09-28 03:00:12] INFO: Integrity check: PASSED
[2025-09-28 03:00:13] INFO: Backup completed successfully
[2025-09-28 03:00:13] INFO: Backup file: /backup/database.sql
[2025-09-28 03:00:13] INFO: Backup timestamp: 2025-09-28 03:00:00
root@fd149cd359fd:/backup# psql -U postgres -c 'CREATE DATABASE production_db;'; tmux wait -S done
psql: error: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: FATAL:  Peer authentication failed for user "postgres"
root@fd149cd359fd:/backup# psql -U postgres -d production_db -f /backup/database.sql; tmux wait -S done
psql: error: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: FATAL:  Peer authentication failed for user "postgres"
root@fd149cd359fd:/backup# psql -U postgres -d production_db -c '\dt'; tmux wait -S done
psql: error: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: FATAL:  Peer authentication failed for user "postgres"
root@fd149cd359fd:/backup# psql -U postgres -d production_db -c '\d users'; tmux wait -S done
psql: error: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: FATAL:  Peer authentication failed for user "postgres"
root@fd149cd359fd:/backup# psql -U postgres -d production_db -c '\d transactions'; tmux wait -S done
psql: error: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: FATAL:  Peer authentication failed for user "postgres"
root@fd149cd359fd:/backup# su - postgres -c "psql -c 'CREATE DATABASE production_db;'"; tmux wait -S done
CREATE DATABASE
root@fd149cd359fd:/backup# su - postgres -c "psql -d production_db -f /backup/database.sql"; tmux wait -S done
CREATE TABLE
CREATE TABLE
root@fd149cd359fd:/backup# su - postgres -c "psql -d production_db -c '\dt'"; tmux wait -S done
            List of relations
 Schema |     Name     | Type  |  Owner
--------+--------------+-------+----------
 public | transactions | table | postgres
 public | users        | table | postgres
(2 rows)

root@fd149cd359fd:/backup# su - postgres -c "psql -d production_db -c '\d users'"; tmux wait -S done
                           Table "public.users"
   Column   |            Type             | Collation | Nullable | Default
------------+-----------------------------+-----------+----------+---------
 user_id    | integer                     |           | not null |
 username   | character varying(100)      |           | not null |
 email      | character varying(255)      |           | not null |
 created_at | timestamp without time zone |           |          |
 status     | character varying(20)       |           |          |
Indexes:
    "users_pkey" PRIMARY KEY, btree (user_id)
Referenced by:
    TABLE "transactions" CONSTRAINT "transactions_user_id_fkey" FOREIGN KEY (user_id) REFERENCES users(user_id)

root@fd149cd359fd:/backup# su - postgres -c "psql -d production_db -c '\d transactions'"; tmux wait -S done
                          Table "public.transactions"
     Column     |            Type             | Collation | Nullable | Default
----------------+-----------------------------+-----------+----------+---------
 transaction_id | integer                     |           | not null |
 user_id        | integer                     |           |          |
 amount         | numeric(10,2)               |           |          |
 timestamp      | timestamp without time zone |           |          |
 description    | text                        |           |          |
Indexes:
    "transactions_pkey" PRIMARY KEY, btree (transaction_id)
Foreign-key constraints:
    "transactions_user_id_fkey" FOREIGN KEY (user_id) REFERENCES users(user_id)

root@fd149cd359fd:/backup# cat > /backup/clean_data.py << 'EOF'
> import csv
> import json
> import re
>
> # Clean users data
> valid_statuses = {'active', 'inactive', 'suspended'}
> clean_users = []
>
> with open('/backup/users_export.csv', 'r') as f:
>     reader = csv.DictReader(f)
>     for row in reader:
>         # Check for missing user_id
>         if not row.get('user_id') or not row['user_id'].strip():
>             continue
>         # Check for empty username
>         if not row.get('username') or not row['username'].strip():
>             continue
>         # Check for invalid email (must contain @)
>         if not row.get('email') or '@' not in row['email']:
>             continue
>         # Check for invalid status
>         if not row.get('status') or row['status'].strip() not in valid_statuses:
>             continue
>         clean_users.append(row)
>
> # Write clean users to CSV
> with open('/backup/clean_users.csv', 'w', newline='') as f:
>     if clean_users:
>         fieldnames = ['user_id', 'username', 'email', 'created_at', 'status']
>         writer = csv.DictWriter(f, fieldnames=fieldnames)
>         writer.writeheader()
>         writer.writerows(clean_users)
>
> print(f'Cleaned users: {len(clean_users)} valid rows')
>
> # Clean transactions data
> with open('/backup/transactions_backup.json', 'r') as f:
>     transactions = json.load(f)
>
> valid_transactions = []
> for txn in transactions:
>     # Check for null transaction_id
>     if txn.get('transaction_id') is None:
>         continue
>     # Check for null or negative amount
>     if txn.get('amount') is None or txn['amount'] <= 0:
>         continue
>     # Check for missing timestamp
>     if not txn.get('timestamp'):
>         continue
>     # Check for invalid user_id (must be 1-30)
>     if txn.get('user_id') is None or txn['user_id'] < 1 or txn['user_id'] > 30:
>         continue
>     valid_transactions.append(txn)
>
> # Write valid transactions to JSON
> with open('/backup/valid_transactions.json', 'w') as f:
>     json.dump(valid_transactions, f, indent=2)
>     f.write('\n')
>
> print(f'Valid transactions: {len(valid_transactions)} valid entries')
> EOF
root@fd149cd359fd:/backup# python3 /backup/clean_data.py; tmux wait -S done
Cleaned users: 30 valid rows
Traceback (most recent call last):
  File "/backup/clean_data.py", line 46, in <module>
    if txn.get('amount') is None or txn['amount'] <= 0:
                                    ^^^^^^^^^^^^^^^^^^
TypeError: '<=' not supported between instances of 'str' and 'int'
root@fd149cd359fd:/backup# cat > /backup/clean_data.py << 'EOF'
> import csv
> import json
> import re
>
> # Clean users data
> valid_statuses = {'active', 'inactive', 'suspended'}
> clean_users = []
>
> with open('/backup/users_export.csv', 'r') as f:
>     reader = csv.DictReader(f)
>     for row in reader:
>         # Check for missing user_id
>         if not row.get('user_id') or not row['user_id'].strip():
>             continue
>         # Check for empty username
>         if not row.get('username') or not row['username'].strip():
>             continue
>         # Check for invalid email (must contain @)
>         if not row.get('email') or '@' not in row['email']:
>             continue
>         # Check for invalid status
>         if not row.get('status') or row['status'].strip() not in valid_statuses:
>             continue
>         clean_users.append(row)
>
> # Write clean users to CSV
> with open('/backup/clean_users.csv', 'w', newline='') as f:
>     if clean_users:
>         fieldnames = ['user_id', 'username', 'email', 'created_at', 'status']
>         writer = csv.DictWriter(f, fieldnames=fieldnames)
>         writer.writeheader()
>         writer.writerows(clean_users)
>
> print(f'Cleaned users: {len(clean_users)} valid rows')
>
> # Clean transactions data
> with open('/backup/transactions_backup.json', 'r') as f:
>     transactions = json.load(f)
>
> valid_transactions = []
> for txn in transactions:
>     # Check for null transaction_id
>     if txn.get('transaction_id') is None:
>         continue
>
>     # Check for null or negative amount
>     amount = txn.get('amount')
>     if amount is None:
>         continue
>     try:
>         amount_float = float(amount)
>         if amount_float <= 0:
>             continue
>     except (ValueError, TypeError):
>         continue
>
>     # Check for missing timestamp
>     if not txn.get('timestamp'):
>         continue
>
>     # Check for invalid user_id (must be 1-30)
>     user_id = txn.get('user_id')
>     if user_id is None:
>         continue
>     try:
>         user_id_int = int(user_id)
>         if user_id_int < 1 or user_id_int > 30:
>             continue
>     except (ValueError, TypeError):
>         continue
>
>     valid_transactions.append(txn)
>
> # Write valid transactions to JSON
> with open('/backup/valid_transactions.json', 'w') as f:
>     json.dump(valid_transactions, f, indent=2)
>     f.write('\n')
>
> print(f'Valid transactions: {len(valid_transactions)} valid entries')
> EOF
root@fd149cd359fd:/backup# python3 /backup/clean_data.py; tmux wait -S done
Cleaned users: 30 valid rows
Valid transactions: 100 valid entries
root@fd149cd359fd:/backup# su - postgres -c "psql -d production_db -c \"COPY users(user_id, username, email, created_at, status) FROM '/backup/clean_users.csv'
WITH (FORMAT csv, HEADER true);\""; tmux wait -S done
COPY 30
root@fd149cd359fd:/backup# su - postgres -c "psql -d production_db -c 'SELECT COUNT(*) FROM users;'"; tmux wait -S done
 count
-------
    30
(1 row)

root@fd149cd359fd:/backup# cat > /backup/import_transactions.py << 'EOF'
> import json
> import psycopg2
>
> # Load valid transactions
> with open('/backup/valid_transactions.json', 'r') as f:
>     transactions = json.load(f)
>
> # Connect to database
> conn = psycopg2.connect(
>     dbname='production_db',
>     user='postgres',
>     host='/var/run/postgresql'
> )
> cur = conn.cursor()
>
> # Insert transactions
> for txn in transactions:
>     cur.execute(
>         "INSERT INTO transactions (transaction_id, user_id, amount, timestamp, description) VALUES (%s, %s, %s, %s, %s)",
>         (txn['transaction_id'], txn['user_id'], txn['amount'], txn['timestamp'], txn.get('description', ''))
>     )
>
> conn.commit()
> print(f'Imported {len(transactions)} transactions')
>
> cur.close()
> conn.close()
> EOF
root@fd149cd359fd:/backup# python3 /backup/import_transactions.py; tmux wait -S done
Traceback (most recent call last):
  File "/backup/import_transactions.py", line 2, in <module>
    import psycopg2
ModuleNotFoundError: No module named 'psycopg2'
root@fd149cd359fd:/backup# cat > /backup/import_transactions.py << 'EOF'
> import json
>
> # Load valid transactions
> with open('/backup/valid_transactions.json', 'r') as f:
>     transactions = json.load(f)
>
> # Generate SQL INSERT statements
> with open('/backup/insert_transactions.sql', 'w') as f:
>     for txn in transactions:
>         description = txn.get('description', '').replace("'", "''")
>         sql = f"INSERT INTO transactions (transaction_id, user_id, amount, timestamp, description) VALUES ({txn['transaction_id']}, {txn['user_id']}, {txn['am
ount']}, '{txn['timestamp']}', '{description}');\n"
>         f.write(sql)
>
> print(f'Generated SQL for {len(transactions)} transactions')
> EOF
root@fd149cd359fd:/backup# python3 /backup/import_transactions.py; tmux wait -S done
Generated SQL for 100 transactions
root@fd149cd359fd:/backup# su - postgres -c "psql -d production_db -f /backup/insert_transactions.sql"; tmux wait -S done
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
root@fd149cd359fd:/backup# su - postgres -c "psql -d production_db -c 'SELECT COUNT(*) FROM transactions;'"; tmux wait -S done
 count
-------
   100
(1 row)

root@fd149cd359fd:/backup# cat > /backup/generate_reports.py << 'EOF'
> import subprocess
> import re
>
> # Generate database statistics report
> print('Generating database statistics...')
>
> # Query total users
> result = subprocess.run(
>     ['su', '-', 'postgres', '-c', "psql -d production_db -t -c 'SELECT COUNT(*) FROM users;'"],
>     capture_output=True, text=True
> )
> total_users = result.stdout.strip()
>
> # Query active users
> result = subprocess.run(
>     ['su', '-', 'postgres', '-c', "psql -d production_db -t -c \"SELECT COUNT(*) FROM users WHERE status = 'active';\""],
>     capture_output=True, text=True
> )
> active_users = result.stdout.strip()
>
> # Query total transactions
> result = subprocess.run(
>     ['su', '-', 'postgres', '-c', "psql -d production_db -t -c 'SELECT COUNT(*) FROM transactions;'"],
>     capture_output=True, text=True
> )
> total_transactions = result.stdout.strip()
>
> # Query total amount
> result = subprocess.run(
>     ['su', '-', 'postgres', '-c', "psql -d production_db -t -c 'SELECT SUM(amount) FROM transactions;'"],
>     capture_output=True, text=True
> )
> total_amount = float(result.stdout.strip())
>
> # Query average per user
> result = subprocess.run(
>     ['su', '-', 'postgres', '-c', "psql -d production_db -t -c 'SELECT AVG(total) FROM (SELECT user_id, SUM(amount) as total FROM transactions GROUP BY user_i
d) subq;'"],
>     capture_output=True, text=True
> )
> avg_per_user = float(result.stdout.strip())
>
> # Write db_stats.txt
> with open('/backup/db_stats.txt', 'w') as f:
>     f.write('DATABASE STATISTICS\n')
>     f.write('==================\n')
>     f.write(f'Total Users: {total_users}\n')
>     f.write(f'Active Users: {active_users}\n')
>     f.write(f'Total Transactions: {total_transactions}\n')
>     f.write(f'Total Amount: {total_amount:.2f}\n')
>     f.write(f'Average per User: {avg_per_user:.2f}\n')
>
> print('Database statistics report created')
>
> # Generate top users report
> print('Generating top users report...')
>
> result = subprocess.run(
>     ['su', '-', 'postgres', '-c',
>      "psql -d production_db -t -A -F',' -c \"SELECT u.username, ROUND(SUM(t.amount)::numeric, 2) as total_amount FROM users u JOIN transactions t ON u.user_id
 = t.user_id GROUP BY u.username ORDER BY total_amount DESC, u.username ASC LIMIT 10;\""],
>     capture_output=True, text=True
> )
>
> top_users_data = result.stdout.strip()
>
> with open('/backup/top_users.csv', 'w') as f:
>     f.write('username,total_amount\n')
>     f.write(top_users_data)
>     f.write('\n')
>
> print('Top users report created')
>
> # Generate backup verification report
> print('Generating backup verification report...')
>
> with open('/backup/backup_metadata.log', 'r') as f:
>     log_content = f.read()
>
> # Extract information
> backup_date = None
> tables_backed_up = None
> total_rows = None
> integrity_check = None
>
> for line in log_content.split('\n'):
>     if 'Backup timestamp:' in line:
>         backup_date = line.split('Backup timestamp:')[1].strip()
>     elif 'Total tables backed up:' in line:
>         tables_backed_up = line.split('Total tables backed up:')[1].strip()
>     elif 'Total rows backed up:' in line:
>         total_rows = line.split('Total rows backed up:')[1].strip()
>     elif 'Integrity check:' in line:
>         integrity_check = line.split('Integrity check:')[1].strip()
>
> with open('/backup/backup_verification.txt', 'w') as f:
>     f.write('BACKUP VERIFICATION\n')
>     f.write('===================\n')
>     f.write(f'Backup Date: {backup_date}\n')
>     f.write(f'Tables Backed Up: {tables_backed_up}\n')
>     f.write(f'Total Rows: {total_rows}\n')
>     f.write(f'Integrity Check: {integrity_check}\n')
>
> print('Backup verification report created')
> EOF
root@fd149cd359fd:/backup# python3 /backup/generate_reports.py; tmux wait -S done
Generating database statistics...
Database statistics report created
Generating top users report...
Top users report created
Generating backup verification report...
Backup verification report created
root@fd149cd359fd:/backup# cat /backup/db_stats.txt; tmux wait -S done
DATABASE STATISTICS
==================
Total Users: 30
Active Users: 13
Total Transactions: 100
Total Amount: 53109.46
Average per User: 1770.32
root@fd149cd359fd:/backup# cat /backup/top_users.csv; tmux wait -S done
username,total_amount
zara_ahmed,4400.17
alice_smith,3682.87
victor_von,3451.21
donna_noble,3225.49
xavier_prof,2990.51
nick_fury,2709.20
wade_wilson,2678.95
tony_stark,2637.00
frank_white,2539.97
charlie_brown,2525.32
root@fd149cd359fd:/backup# cat /backup/backup_verification.txt; tmux wait -S done
BACKUP VERIFICATION
===================
Backup Date: 2025-09-28 03:00:00
Tables Backed Up: 2
Total Rows: 130
Integrity Check: PASSED
root@fd149cd359fd:/backup# head -5 /backup/clean_users.csv; tmux wait -S done
user_id,username,email,created_at,status
1,alice_smith,alice_smith@example.com,2024-11-21 01:25:46,inactive
2,bob_jones,bob_jones@example.com,2025-06-28 01:25:46,active
3,charlie_brown,charlie_brown@example.com,2025-08-13 01:25:46,suspended
4,diana_prince,diana_prince@example.com,2025-08-05 01:25:46,inactive
root@fd149cd359fd:/backup# head -20 /backup/valid_transactions.json; tmux wait -S done
[
  {
    "transaction_id": 1,
    "user_id": 16,
    "amount": 46.0,
    "timestamp": "2025-07-16 01:25:56",
    "description": "Subscription"
  },
  {
    "transaction_id": 2,
    "user_id": 6,
    "amount": 646.05,
    "timestamp": "2025-05-02 01:25:56",
    "description": "Payment"
  },
  {
    "transaction_id": 3,
    "user_id": 29,
    "amount": 186.76,
    "timestamp": "2025-07-30 01:25:56",
root@fd149cd359fd:/backup# wc -l /backup/top_users.csv; tmux wait -S done
11 /backup/top_users.csv
root@fd149cd359fd:/backup# cat /backup/top_users.csv; tmux wait -S done
username,total_amount
zara_ahmed,4400.17
alice_smith,3682.87
victor_von,3451.21
donna_noble,3225.49
xavier_prof,2990.51
nick_fury,2709.20
wade_wilson,2678.95
tony_stark,2637.00
frank_white,2539.97
charlie_brown,2525.32
root@fd149cd359fd:/backup# cat /backup/db_stats.txt; tmux wait -S done
DATABASE STATISTICS
==================
Total Users: 30
Active Users: 13
Total Transactions: 100
Total Amount: 53109.46
Average per User: 1770.32
root@fd149cd359fd:/backup# ls -la /backup/*.txt /backup/*.csv /backup/*.json | grep -E '(clean_users|valid_transactions|db_stats|top_users|backup_verification)'
; tmux wait -S done
-rw-r--r-- 1 root root   133 Dec  4 17:55 /backup/backup_verification.txt
-rw-r--r-- 1 root root  2052 Dec  4 17:55 /backup/clean_users.csv
-rw-r--r-- 1 root root   145 Dec  4 17:55 /backup/db_stats.txt
-rw-r--r-- 1 root root   219 Dec  4 17:55 /backup/top_users.csv
-rw-r--r-- 1 root root 14573 Dec  4 17:55 /backup/valid_transactions.json
root@fd149cd359fd:/backup# echo 'RECOVERY_SUCCESSFUL' > /backup/recovery_complete.txt; tmux wait -S done
root@fd149cd359fd:/backup# cat /backup/recovery_complete.txt; tmux wait -S done
RECOVERY_SUCCESSFUL
root@fd149cd359fd:/backup# su - postgres -c "psql -d production_db -c 'SELECT COUNT(*) as user_count FROM users; SELECT COUNT(*) as txn_count FROM transactions;
'"; tmux wait -S done
 user_count
------------
         30
(1 row)

 txn_count
-----------
       100
(1 row)

root@fd149cd359fd:/backup# ls -1 /backup/ | grep -E '^(clean_users\.csv|valid_transactions\.json|db_stats\.txt|top_users\.csv|backup_verification\.txt|recovery_
complete\.txt)$'; tmux wait -S done
backup_verification.txt
clean_users.csv
db_stats.txt
recovery_complete.txt
top_users.csv
valid_transactions.json
root@fd149cd359fd:/backup# echo 'All tasks completed successfully!'; tmux wait -S done
All tasks completed successfully!
root@fd149cd359fd:/backup# echo 'Database recovery process completed. All requirements satisfied.'; tmux wait -S done
Database recovery process completed. All requirements satisfied.
root@fd149cd359fd:/backup#
