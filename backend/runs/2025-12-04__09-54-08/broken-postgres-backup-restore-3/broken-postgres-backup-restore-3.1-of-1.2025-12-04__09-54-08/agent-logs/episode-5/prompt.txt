>             # Check for invalid status
>             if row.get('status', '').strip().lower() not in VALID_STATUSES:
>                 continue
>
>             valid_rows.append(row)
>
>     return valid_rows
>
> def write_clean_csv(rows):
>     """Write cleaned data to clean_users.csv"""
>     with open('/backup/clean_users.csv', 'w', newline='') as f:
>         if rows:
>             writer = csv.DictWriter(f, fieldnames=['user_id', 'username', 'email', 'created_at', 'status'])
>             writer.writeheader()
>             writer.writerows(rows)
>
> if __name__ == '__main__':
>     print("Cleaning users data...")
>     valid_rows = clean_users()
>     print(f"Valid rows: {len(valid_rows)}")
>
>     print("Writing clean_users.csv...")
>     write_clean_csv(valid_rows)
>
>     print("Done!")
> EOF
root@649ce5c0dfcd:/backup# python3 clean_users.py; tmux wait -S done
Cleaning users data...
Valid rows: 30
Writing clean_users.csv...
Done!
root@649ce5c0dfcd:/backup# head -5 clean_users.csv; tmux wait -S done
user_id,username,email,created_at,status
1,alice_smith,alice_smith@example.com,2024-11-21 01:25:46,inactive
2,bob_jones,bob_jones@example.com,2025-06-28 01:25:46,active
3,charlie_brown,charlie_brown@example.com,2025-08-13 01:25:46,suspended
4,diana_prince,diana_prince@example.com,2025-08-05 01:25:46,inactive
root@649ce5c0dfcd:/backup# wc -l clean_users.csv; tmux wait -S done
31 clean_users.csv
root@649ce5c0dfcd:/backup#
