> for tx in transactions:
>     # Check transaction_id is not null
>     if tx.get('transaction_id') is None:
>         continue
>
>     # Check amount is not null and is positive
>     if tx.get('amount') is None or tx['amount'] <= 0:
>         continue
>
>     # Check timestamp exists
>     if not tx.get('timestamp'):
>         continue
>
>     # Check user_id is valid (1-30)
>     if tx.get('user_id') is None or tx['user_id'] < 1 or tx['user_id'] > 30:
>         continue
>
>     valid_transactions.append(tx)
>
> # Write valid transactions
> with open('/backup/valid_transactions.json', 'w') as f:
>     json.dump(valid_transactions, f, indent=2)
>     f.write('\n')
>
> print(f'Cleaned {len(valid_transactions)} valid transactions out of {len(transactions)} total')
> EOF
root@4fba2045470e:/backup# python3 /tmp/clean_transactions.py; tmux wait -S done
Traceback (most recent call last):
  File "/tmp/clean_transactions.py", line 15, in <module>
    if tx.get('amount') is None or tx['amount'] <= 0:
                                   ^^^^^^^^^^^^^^^^^
TypeError: '<=' not supported between instances of 'str' and 'int'
root@4fba2045470e:/backup# head -30 /backup/valid_transactions.json; tmux wait -S done
head: cannot open '/backup/valid_transactions.json' for reading: No such file or directory
root@4fba2045470e:/backup# python3 -c "import json; data=json.load(open('/backup/valid_transactions.json')); print(f'Valid transactions: {len(data)}')"; tmux wa
it -S done
Traceback (most recent call last):
  File "<string>", line 1, in <module>
FileNotFoundError: [Errno 2] No such file or directory: '/backup/valid_transactions.json'
root@4fba2045470e:/backup#
