> conn.commit()
> cur.close()
> conn.close()
>
> print("Data import completed successfully")
> EOF
root@4fba2045470e:/backup# su - postgres -c "cd /backup && python3 /tmp/import_data.py"; tmux wait -S done
Traceback (most recent call last):
  File "/tmp/import_data.py", line 1, in <module>
    import psycopg2
ModuleNotFoundError: No module named 'psycopg2'
root@4fba2045470e:/backup# su - postgres -c "psql -d production_db -c 'SELECT COUNT(*) FROM users;'"; tmux wait -S done
 count
-------
     0
(1 row)

root@4fba2045470e:/backup# su - postgres -c "psql -d production_db -c 'SELECT COUNT(*) FROM transactions;'"; tmux wait -S done
 count
-------
     0
(1 row)

root@4fba2045470e:/backup# cat > /tmp/import_users.py << 'EOF'
> import csv
>
> # Generate SQL INSERT statements for users
> with open('/backup/clean_users.csv', 'r') as f:
>     reader = csv.DictReader(f)
>     with open('/tmp/users_import.sql', 'w') as out:
>         for row in reader:
>             sql = f"INSERT INTO users (user_id, username, email, created_at, status) VALUES ({row['user_id']}, '{row['username']}', '{row['email']}', '{row['c
reated_at']}', '{row['status']}');\n"
>             out.write(sql)
>
> print("Generated users import SQL")
> EOF
root@4fba2045470e:/backup# python3 /tmp/import_users.py; tmux wait -S done
Generated users import SQL
root@4fba2045470e:/backup#
