>             continue
>
>         # Check if username exists and is not empty
>         if not row.get('username') or not row['username'].strip():
>             continue
>
>         # Check if email exists and contains @
>         if not row.get('email') or not email_pattern.match(row['email']):
>             continue
>
>         # Check if status is valid
>         if not row.get('status') or row['status'].strip() not in valid_statuses:
>             continue
>
>         clean_rows.append(row)
>
> # Write cleaned data
> with open('/backup/clean_users.csv', 'w', newline='') as f:
>     writer = csv.DictWriter(f, fieldnames=header)
>     writer.writeheader()
>     writer.writerows(clean_rows)
>
> print(f'Cleaned {len(clean_rows)} valid users out of original data')
> EOF
root@4fba2045470e:/backup# python3 /tmp/clean_users.py; tmux wait -S done
Cleaned 30 valid users out of original data
root@4fba2045470e:/backup# head -10 /backup/clean_users.csv; tmux wait -S done
user_id,username,email,created_at,status
1,alice_smith,alice_smith@example.com,2024-11-21 01:25:46,inactive
2,bob_jones,bob_jones@example.com,2025-06-28 01:25:46,active
3,charlie_brown,charlie_brown@example.com,2025-08-13 01:25:46,suspended
4,diana_prince,diana_prince@example.com,2025-08-05 01:25:46,inactive
5,eve_adams,eve_adams@example.com,2025-09-08 01:25:46,inactive
6,frank_white,frank_white@example.com,2025-09-04 01:25:46,active
7,grace_lee,grace_lee@example.com,2025-06-05 01:25:46,active
8,henry_ford,henry_ford@example.com,2025-07-25 01:25:46,inactive
9,iris_west,iris_west@example.com,2025-03-23 01:25:46,suspended
root@4fba2045470e:/backup# wc -l /backup/clean_users.csv; tmux wait -S done
31 /backup/clean_users.csv
root@4fba2045470e:/backup#
