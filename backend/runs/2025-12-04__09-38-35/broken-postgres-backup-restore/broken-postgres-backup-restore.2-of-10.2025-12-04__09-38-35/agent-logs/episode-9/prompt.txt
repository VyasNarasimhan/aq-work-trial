>
>     # Check amount is not null and is positive
>     amount = tx.get('amount')
>     if amount is None:
>         continue
>
>     # Try to convert amount to float and check if positive
>     try:
>         amount_val = float(amount)
>         if amount_val <= 0:
>             continue
>     except (ValueError, TypeError):
>         continue
>
>     # Check timestamp exists
>     if not tx.get('timestamp'):
>         continue
>
>     # Check user_id is valid (1-30)
>     user_id = tx.get('user_id')
>     if user_id is None:
>         continue
>
>     try:
>         user_id_val = int(user_id)
>         if user_id_val < 1 or user_id_val > 30:
>             continue
>     except (ValueError, TypeError):
>         continue
>
>     valid_transactions.append(tx)
>
> # Write valid transactions
> with open('/backup/valid_transactions.json', 'w') as f:
>     json.dump(valid_transactions, f, indent=2)
>     f.write('\n')
>
> print(f'Cleaned {len(valid_transactions)} valid transactions out of {len(transactions)} total')
> EOF
root@4fba2045470e:/backup#
