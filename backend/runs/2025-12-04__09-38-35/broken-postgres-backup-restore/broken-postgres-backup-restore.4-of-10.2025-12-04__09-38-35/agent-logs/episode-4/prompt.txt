>
>         # Check for invalid email (must contain @)
>         email = row.get('email', '').strip()
>         if not email or '@' not in email:
>             continue
>
>         # Check for invalid status
>         status = row.get('status', '').strip()
>         if status not in valid_statuses:
>             continue
>
>         # Write valid row
>         writer.writerow({
>             'user_id': row['user_id'].strip(),
>             'username': row['username'].strip(),
>             'email': email,
>             'created_at': row.get('created_at', '').strip(),
>             'status': status
>         })
> EOF
root@8f19f1956b2f:/backup# python3 /backup/clean_users.py; tmux wait -S done
root@8f19f1956b2f:/backup# head -15 /backup/clean_users.csv; tmux wait -S done
user_id,username,email,created_at,status
1,alice_smith,alice_smith@example.com,2024-11-21 01:25:46,inactive
2,bob_jones,bob_jones@example.com,2025-06-28 01:25:46,active
3,charlie_brown,charlie_brown@example.com,2025-08-13 01:25:46,suspended
4,diana_prince,diana_prince@example.com,2025-08-05 01:25:46,inactive
5,eve_adams,eve_adams@example.com,2025-09-08 01:25:46,inactive
6,frank_white,frank_white@example.com,2025-09-04 01:25:46,active
7,grace_lee,grace_lee@example.com,2025-06-05 01:25:46,active
8,henry_ford,henry_ford@example.com,2025-07-25 01:25:46,inactive
9,iris_west,iris_west@example.com,2025-03-23 01:25:46,suspended
10,jack_ryan,jack_ryan@example.com,2024-10-19 01:25:46,inactive
11,kate_mills,kate_mills@example.com,2025-06-27 01:25:46,active
12,leo_king,leo_king@example.com,2024-12-21 01:25:46,inactive
13,mary_jane,mary_jane@example.com,2025-10-03 01:25:46,suspended
14,nick_fury,nick_fury@example.com,2025-04-03 01:25:46,suspended
root@8f19f1956b2f:/backup# wc -l /backup/clean_users.csv; tmux wait -S done
31 /backup/clean_users.csv
root@8f19f1956b2f:/backup#
