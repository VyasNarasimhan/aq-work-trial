>     transactions = json.load(f)
>
> # Write to CSV
> with open('/backup/transactions.csv', 'w', newline='') as f:
>     writer = csv.writer(f)
>     writer.writerow(['transaction_id', 'user_id', 'amount', 'timestamp', 'description'])
>     for txn in transactions:
>         writer.writerow([
>             txn['transaction_id'],
>             txn['user_id'],
>             txn['amount'],
>             txn['timestamp'],
>             txn['description']
>         ])
>
> print(f"Converted {len(transactions)} transactions to CSV")
> EOF
root@8f19f1956b2f:/backup# python3 /backup/json_to_csv.py; tmux wait -S done
Converted 100 transactions to CSV
root@8f19f1956b2f:/backup# head -10 /backup/transactions.csv; tmux wait -S done
transaction_id,user_id,amount,timestamp,description
1,16,46.0,2025-07-16 01:25:56,Subscription
2,6,646.05,2025-05-02 01:25:56,Payment
3,29,186.76,2025-07-30 01:25:56,Payment
4,10,757.37,2025-09-03 01:25:56,Deposit
5,9,366.3,2025-09-21 01:25:56,Refund
6,6,540.38,2025-06-18 01:25:56,Transfer
7,1,450.03,2025-05-07 01:25:56,Refund
8,12,875.23,2025-05-22 01:25:56,Payment
9,22,89.57,2025-09-30 01:25:56,Deposit
root@8f19f1956b2f:/backup# su - postgres -c "psql -d production_db -c \"COPY transactions(transaction_id, user_id, amount, timestamp, description) FROM '/backup
/transactions.csv' WITH (FORMAT csv, HEADER true);\""; tmux wait -S done
COPY 100
root@8f19f1956b2f:/backup# su - postgres -c "psql -d production_db -c 'SELECT COUNT(*) FROM transactions;'"; tmux wait -S done
 count
-------
   100
(1 row)

root@8f19f1956b2f:/backup#
