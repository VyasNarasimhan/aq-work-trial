>
> for txn in transactions:
>     # Check for null transaction_id
>     if txn.get('transaction_id') is None:
>         continue
>
>     # Check for null or invalid user_id (must be 1-30)
>     user_id = txn.get('user_id')
>     if user_id is None or not isinstance(user_id, int) or user_id < 1 or user_id > 30:
>         continue
>
>     # Check for null, negative, or invalid amount
>     amount = txn.get('amount')
>     if amount is None:
>         continue
>
>     # Handle string amounts or non-numeric
>     try:
>         amount_val = float(amount)
>         if amount_val <= 0:
>             continue
>     except (ValueError, TypeError):
>         continue
>
>     # Check for missing timestamp
>     if txn.get('timestamp') is None or txn.get('timestamp') == '':
>         continue
>
>     valid_transactions.append(txn)
>
> # Write valid transactions
> with open('/backup/valid_transactions.json', 'w') as f:
>     json.dump(valid_transactions, f, indent=2)
>     f.write('\n')
>
> print(f'Valid transactions: {len(valid_transactions)} out of {len(transactions)}')
> EOF
root@bbbc5313bf43:/backup# python3 /backup/clean_transactions.py; tmux wait -S done
Valid transactions: 100 out of 106
root@bbbc5313bf43:/backup#
