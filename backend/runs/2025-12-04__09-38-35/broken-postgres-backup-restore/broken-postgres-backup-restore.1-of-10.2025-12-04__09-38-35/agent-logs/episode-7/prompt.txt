>
>     for row in reader:
>         # Check for missing user_id
>         if not row.get('user_id') or row['user_id'].strip() == '':
>             continue
>
>         # Check for empty username
>         if not row.get('username') or row['username'].strip() == '':
>             continue
>
>         # Check for invalid email (must contain @)
>         email = row.get('email', '')
>         if not email or '@' not in email:
>             continue
>
>         # Check for invalid status
>         status = row.get('status', '')
>         if status not in valid_statuses:
>             continue
>
>         clean_rows.append(row)
>
> # Write cleaned data
> with open('/backup/clean_users.csv', 'w', newline='') as outfile:
>     fieldnames = ['user_id', 'username', 'email', 'created_at', 'status']
>     writer = csv.DictWriter(outfile, fieldnames=fieldnames)
>     writer.writeheader()
>     writer.writerows(clean_rows)
>
> print(f'Cleaned users: {len(clean_rows)} valid rows')
> EOF
root@bbbc5313bf43:/backup# python3 /backup/clean_users.py; tmux wait -S done
Cleaned users: 30 valid rows
root@bbbc5313bf43:/backup# head -5 /backup/clean_users.csv; tmux wait -S done
user_id,username,email,created_at,status
1,alice_smith,alice_smith@example.com,2024-11-21 01:25:46,inactive
2,bob_jones,bob_jones@example.com,2025-06-28 01:25:46,active
3,charlie_brown,charlie_brown@example.com,2025-08-13 01:25:46,suspended
4,diana_prince,diana_prince@example.com,2025-08-05 01:25:46,inactive
root@bbbc5313bf43:/backup#
